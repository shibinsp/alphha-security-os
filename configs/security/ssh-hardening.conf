#===============================================================================
# Alphha Security OS - SSH Hardening Configuration
# Copyright (c) 2026 Alphha Team
# File: /etc/ssh/sshd_config.d/alphha-hardening.conf
#===============================================================================

#-------------------------------------------------------------------------------
# Authentication
#-------------------------------------------------------------------------------

# Disable root login
PermitRootLogin no

# Enable public key authentication
PubkeyAuthentication yes

# Enable password authentication (disable for key-only access)
PasswordAuthentication yes

# Disable empty passwords
PermitEmptyPasswords no

# Maximum authentication attempts
MaxAuthTries 3

# Maximum sessions per connection
MaxSessions 3

# Authentication timeout
LoginGraceTime 30

# Disable challenge-response authentication
ChallengeResponseAuthentication no

# Disable Kerberos authentication
KerberosAuthentication no

# Disable GSSAPI authentication
GSSAPIAuthentication no

#-------------------------------------------------------------------------------
# Security Options
#-------------------------------------------------------------------------------

# Use protocol version 2 only
Protocol 2

# Disable X11 forwarding
X11Forwarding no

# Disable agent forwarding
AllowAgentForwarding no

# Disable TCP forwarding
AllowTcpForwarding no

# Disable gateway ports
GatewayPorts no

# Disable tunneling
PermitTunnel no

# Disable user environment
PermitUserEnvironment no

# Disable stream local forwarding
AllowStreamLocalForwarding no

#-------------------------------------------------------------------------------
# Cryptographic Settings
#-------------------------------------------------------------------------------

# Strong ciphers only
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr

# Strong MACs only
MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256

# Strong key exchange algorithms
KexAlgorithms curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group-exchange-sha256

# Host key algorithms
HostKeyAlgorithms ssh-ed25519,ssh-ed25519-cert-v01@openssh.com,rsa-sha2-512,rsa-sha2-256

#-------------------------------------------------------------------------------
# Connection Settings
#-------------------------------------------------------------------------------

# Client alive interval (seconds)
ClientAliveInterval 300

# Client alive count max
ClientAliveCountMax 2

# TCP keepalive
TCPKeepAlive yes

# Compression (disable for security, enable for slow connections)
Compression no

# Maximum startups before rate limiting
MaxStartups 10:30:60

#-------------------------------------------------------------------------------
# Logging
#-------------------------------------------------------------------------------

# Log level
LogLevel VERBOSE

# Log SFTP access
Subsystem sftp /usr/lib/openssh/sftp-server -l INFO

#-------------------------------------------------------------------------------
# Access Control (customize as needed)
#-------------------------------------------------------------------------------

# Allow specific users (uncomment and modify)
# AllowUsers sentinel admin

# Allow specific groups (uncomment and modify)
# AllowGroups sshusers sudo

# Deny specific users
# DenyUsers root

#-------------------------------------------------------------------------------
# Banner
#-------------------------------------------------------------------------------

# Display banner before authentication
Banner /etc/ssh/banner

#===============================================================================
# End of Alphha Security OS SSH Hardening Configuration
#===============================================================================
